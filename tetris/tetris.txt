-- Hoogle documentation, generated by Haddock
-- See Hoogle, http://www.haskell.org/hoogle/


-- | Tetris, a game
@package tetris
@version 0.0.1.0

module Tetris.Board

-- | A Tetris piece.
--   
--   Pieces are generated via <a>randomPiece</a>.
data Piece

-- | Generates a random piece in the given column.
randomPiece :: Int -> IO Piece

-- | Moves a piece by the given 2D offset.
movePiece :: YX -> Piece -> Piece

-- | Rotates a piece clockwise 90 degrees..
rotatePiece :: Piece -> Piece

-- | Returns the piece's coordinates.
pieceCoords :: Piece -> Set YX

-- | A rectangular Tetris board.
data Board

-- | Creates a new board with the given position as extreme point. If at
--   least one of the given position's fields is negative, the function
--   will return <a>Nothing</a>.
newBoard :: YX -> Maybe Board

-- | Returns the coordinates of all populated positions inside the board.
boardCoords :: Board -> Set YX

-- | Returns the number of columns in the board.
boardWidth :: Board -> Int

-- | Checks whether the given piece fits on the board (i.e. within the
--   boundaries of the board and doesn't overlap with any existing pieces).
fitsOn :: Piece -> Board -> Bool

-- | Adds the piece to the board, clearing any newly filled rows. This
--   function returns the number of cleared rows along with the updated
--   board.
freezePiece :: Piece -> Board -> (Int, Board)
instance GHC.Show.Show Tetris.Board.Piece
instance GHC.Classes.Eq Tetris.Board.Piece
instance GHC.Show.Show Tetris.Board.Tetromino
instance GHC.Classes.Eq Tetris.Board.Tetromino
instance GHC.Enum.Enum Tetris.Board.Tetromino
instance GHC.Enum.Bounded Tetris.Board.Tetromino
instance GHC.Show.Show Tetris.Board.Board
instance GHC.Classes.Eq Tetris.Board.Board


-- | A simple Tetris implementation.
module Tetris

-- | A Tetris game's state.
data Game

-- | Generates a new gave with the given extent. For example, a game with
--   height 24 and width 10 (the standard) can be generated with
--   <tt>newGame (YX 24 10)</tt>.
newGame :: YX -> IO (Maybe Game)

-- | Returns the active piece's coordinates.
activeCoords :: Game -> Set YX

-- | Returns the coordinates of all inactive pieces.
frozenCoords :: Game -> Set YX

-- | A user action.
data Action
MoveDown :: Action
MoveLeft :: Action
MoveRight :: Action
Rotate :: Action

-- | Updates the state of a game with a user's action. If the user's action
--   is invalid (e.g. moving a piece out of bounds), the game's state will
--   remain unchanged.
onAction :: Action -> Game -> Game

-- | A thin wrapper around a game's score.
newtype Score
Score :: Int -> Score

-- | Returns the number of full rows cleared so far.
currentScore :: Game -> Score

-- | Updates the state of the game with the passage of time. More
--   precisely, the following actions are performed in order:
--   
--   <ul>
--   <li>Attempts to move the active piece down. If this is a valid move,
--   the function simply returns the updated game's state.</li>
--   <li>Freezes the active piece.</li>
--   <li>Clears all newly full rows, increasing the score and shifting
--   other rows correspondingly.</li>
--   <li>Generates a new random piece, if this is not possible the game is
--   over and the function returns the game's final score instead of the
--   updated state.</li>
--   </ul>
onTick :: Game -> IO (Either Score Game)
